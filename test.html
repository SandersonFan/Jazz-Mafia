<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Supabase Connection Test</title>
  <style>
    body { background: #181818; color: #e0e0e0; font-family: monospace; padding: 2em; }
    #output { background: #222; padding: 1em; border-radius: 8px; margin-top: 1em; white-space: pre-wrap; }
    button { background: #333; color: #fff; border: none; padding: 0.5em 1em; border-radius: 4px; cursor: pointer; }
    button:hover { background: #444; }
    input { background: #222; color: #fff; border: 1px solid #444; padding: 0.3em; border-radius: 4px; }
  </style>
</head>
<body>
  <h1>Supabase Connection Test</h1>
  <button onclick="testMembers()">Test Members Table</button>
  <button onclick="testBenson()">Test Benson Login</button>
  <div style="margin-top:1em;">
    <label>Test login as: <input id="user" value="benson" style="width:6em;"> <input id="pass" value="fedora" style="width:6em;"> <button onclick="testLogin()">Test Login</button></label>
  </div>
  <div id="output"></div>
  <script>
    const SUPABASE_URL = 'https://uznkkjczakyyinzhmoll.supabase.co';
    const SUPABASE_API_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV6bmtramN6YWt5eWluemhtb2xsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY4MDAyODksImV4cCI6MjA2MjM3NjI4OX0.huw9uasQL8dmS8xfgpZaRfVc-nuy5eMhl6jrE25g5k0';
    const output = document.getElementById('output');

    function log(msg) {
      output.textContent += msg + '\n';
    }
    function clearLog() { output.textContent = ''; }

    async function testMembers() {
      clearLog();
      log('Testing members table...');
      try {
        const res = await fetch(`${SUPABASE_URL}/rest/v1/members`, {
          headers: {
            apikey: SUPABASE_API_KEY,
            Authorization: `Bearer ${SUPABASE_API_KEY}`
          }
        });
        const data = await res.json();
        log('Members table response:');
        log(JSON.stringify(data, null, 2));
      } catch (e) {
        log('Error: ' + e);
      }
    }

    async function testBenson() {
      clearLog();
      log('Testing for Benson in members...');
      try {
        const res = await fetch(`${SUPABASE_URL}/rest/v1/members?name=eq.benson`, {
          headers: {
            apikey: SUPABASE_API_KEY,
            Authorization: `Bearer ${SUPABASE_API_KEY}`
          }
        });
        const data = await res.json();
        log('Benson row:');
        log(JSON.stringify(data, null, 2));
      } catch (e) {
        log('Error: ' + e);
      }
    }

    async function testLogin() {
      clearLog();
      const user = document.getElementById('user').value;
      const pass = document.getElementById('pass').value;
      log(`Testing login for ${user}...`);
      try {
        const res = await fetch(`${SUPABASE_URL}/rest/v1/members?name=eq.${encodeURIComponent(user)}`, {
          headers: {
            apikey: SUPABASE_API_KEY,
            Authorization: `Bearer ${SUPABASE_API_KEY}`
          }
        });
        const data = await res.json();
        if (data.length === 0) {
          log('No such user.');
        } else if (data[0].password === pass) {
          log('Login successful!');
          log(JSON.stringify(data[0], null, 2));
        } else {
          log('Wrong password.');
          log(JSON.stringify(data[0], null, 2));
        }
      } catch (e) {
        log('Error: ' + e);
      }
    }
  </script>
</body>
</html>
